apiVersion: v1
kind: Pod
metadata:
  name: gollum-pod-debug
  namespace: gollum
spec:
  securityContext:
    runAsNonRoot: false
    runAsUser: 1
    runAsGroup: 1
    # fsGroup: 999
    # fsGroupChangePolicy: OnRootMismatch
    # seccompProfile:
    #   type: RuntimeDefault
  containers:
    - name: gollum
      image: gollumwiki/gollum:latest
      command: [ "/bin/sh", "-c", "--" ]
      args: [ "while true; do sleep 30; done;" ]
      securityContext:
        allowPrivilegeEscalation: false
        readOnlyRootFilesystem: true
        capabilities:
          drop: [ "ALL" ]
      ports:
        - name: http
          containerPort: 4567
      volumeMounts:
        - name: gollum-repo
          mountPath: /wiki
      resources:
        requests:
          cpu: 50m
          memory: 12Mi
        limits:
          cpu: 1000m
          memory: 24Mi
  restartPolicy: OnFailure
  volumes:
    - name: gollum-repo
      persistentVolumeClaim:
        claimName: pvc-gollum

